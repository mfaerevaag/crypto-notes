%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../index"
%%% End:

% Recommended:
% Show symmetric-key example with Alice-Bob diagram
% Mention modern algorithm (e.g. AES, Triple-DES)
% Benefits of public-key encryption (no key sharing)
% Show public-key example with RSA and Alice-Bob diagram

\subsection*{Agenda}
\begin{enumerate}
\item Symmetric-key encryption
\item Symmetric- vs. public-key encryption
\item Public-key encryption
\item RSA
\end{enumerate}

\subsection{Symmetric-key encryption}
\subsubsection*{Set up}
\begin{itemize}
\item $m \in \mathcal{P}$ is the plaintext
\item $k \in \mathcal{K}$ is the key
\item $c \in \mathcal{C}$ is the ciphertext
\item $e_k(m)$ encryption function
\item $d_k(c)$ decryption function
\end{itemize}

\begin{figure}[H]
  \begin{centering}
    \includegraphics[width=15cm]{images/1-sym-enc}
    \caption{Basic model for symmetric encryption}
  \end{centering}
  \label{fig:sym-enc}
\end{figure}

\subsubsection*{Modern implementations}
\begin{description}
\item[DES] 64-bit block cipher with 56-bit key. Due to small key,
  exhaustive search is a possibility. Therefore, \emph{Triple-DES} was
  made.
\item[AES] 128-bit block cipher with 128 to 256-bit key.
\end{description}

\subsection{Symmetric- vs. public-key encryption}
\begin{description}
\item[Pros] Faster and easier to implement
\item[Cons] Requires both parties can access the secret key. Impossible?
\end{description}

\subsection{Public-key encryption}
% TODO: Alice Bo
\begin{figure}[H]
  \begin{centering}
    \includegraphics[width=15cm]{images/1-pub-enc}
    \caption{Basic model for public encryption}
  \end{centering}
  \label{fig:pub-enc}
\end{figure}
\subsection{RSA}
\input{systems/rsa-encryp.tex}
\subsubsection*{Weakness}
\begin{itemize}
\item Attacker can get factors of $n$
  \begin{itemize}
  \item If attacker can factor $n$ then he can find $d$ same way that
    the system computes it
  \end{itemize}
\item Attacker finds $\phi (n)$, then factors $n$
  \begin{itemize}
  \item If $n$ is small attacker can setup an equation with two unknowns
    that uses $\phi (n)=(p-1)(q-1)$ since he knows $n=pq$
    \begin{align*}
      \phi(n) &= n - p - q + 1 \\
      p &= n - \phi(n) - q + 1 \quad \text{since } p = \frac{n}{q} \\
      \frac{n}{q} &= n - \phi(n) - q + 1 \\
      0 &= q^2 + q(\phi(n) - n - 1) + n
    \end{align*}
  \end{itemize}
\item Attacker finds the decryption exponent $d$, then factors $n$
  \begin{itemize}
  \item If the attacker finds $d$ it is easy to factor $n$
  \end{itemize}
\item If $c_1$ and $c_2$ are encrypted with the same key then:
  \begin{align*}
    &(c_1c_2)^d \mod n = (c_1^d) (c_2^d) \mod n \\
    &\text{which means} \\
    &(c_1^d) (c_2^d) \mod n = m_1m_2 \mod n
  \end{align*}
\end{itemize}
\subsubsection*{Proof}
\input{proofs/rsa.tex}
