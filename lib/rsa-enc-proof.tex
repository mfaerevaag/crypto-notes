%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../index"
%%% End:

\textbf{Public:} $n = pq$ for primes $p, q$ and encryption exponent $e
\in \mathbb{Z}_{\phi(n)}^*$

\textbf{Private:} $(p, q, d)$ where $d \in \mathbb{Z}_{\phi(n)}^*$, such that
\[ ed \equiv 1 \mod \phi(n) \]

Define $\phi(n) = (p-1)(q-1)$. We have that
\begin{align*}
  & ed \equiv 1 \mod \phi(n)\\
  \Rightarrow\quad& ed = 1 + k(p - 1)(q - 1) \quad \text{where } k \in \mathbb{Z}
\end{align*}

We need to prove that $(m^e)^d \equiv m \mod$ since that is enc and dec using RSA.
\begin{align*}
(m^e)^d &\equiv m \mod n \\
\Rightarrow\quad m^{ed} &\equiv m \mod n
\end{align*}

Chinese Remainder Theorem says that it is enough to show
\[ m^{ed} \equiv m \mod p \quad \textbf{and} \quad m^{ed} \equiv m \mod q \]

Showing for $p$. There are two cases: 1) $m \equiv 0 \mod p$ and 2) $m \not\equiv 0 \mod p$.

\textbf{Case 1}
\begin{align*}
  m &\equiv 0 \mod p\\
  \Rightarrow\quad m^x &\equiv m \mod p \quad \text{for } x \in \mathbb{Z}
\end{align*}
Since $ed \in \mathbb{Z}$, case 1 holds.

\textbf{Case 2}
\begin{align*}
m &\equiv m^{ed} \mod p \\
  &\equiv m^{1 + k(p-1)(q-1)} \mod p \\
  &\equiv m \cdot m^{k(p-1)(q-1)} \mod p \\
  &\equiv m \cdot (m^{(p-1)})^{k(q-1)} \mod p
\end{align*}

From Fermat's little theorem (\ref{sec:fermats-little}) we know that
$x^{p-1} \equiv x \mod p$ for prime $p$. Thus
\begin{align*}
m &\equiv m \cdot 1^{k(q-1)} \mod p \\
  &\equiv m \cdot 1 \mod p \\
  &\equiv m \mod p
\end{align*}

Therefore, case 2 also holds and we have proved for prime $p$.
